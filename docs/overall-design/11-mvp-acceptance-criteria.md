# 步驟 8：MVP 驗收標準

**狀態**：✅ 已完成
**前置依賴**：步驟 01-07
**目標**：定義產品層級的驗收標準，明確什麼叫做「MVP 完成可上線」

---

## 1. MVP 核心定義

### 最小可用產品（MVP）的定義

當用戶能夠：
1. 在網頁上輸入一段文字腳本（最少 3 句話）
2. 點擊「生成影片」按鈕
3. 等待系統處理（可看到進度）
4. 成功產出一支可播放的影片（包含畫面、旁白、字幕）
5. 能預覽並下載該影片

**就算 MVP 完成。**

---

## 2. 核心功能檢查清單

### 必須完成的功能（P0）

- [ ] **腳本輸入功能**
  - 用戶能在前端介面輸入文字
  - 支援多行文字（最少 3 句話）
  - 有基本的輸入驗證（不能空白、長度限制）

- [ ] **AI 腳本分析**
  - 能將文字腳本拆解成多個場景
  - 每個場景有明確的視覺描述
  - 產出結構化的場景資料

- [ ] **素材生成**
  - 能為每個場景生成圖片（AI 或素材庫）
  - 能為整段腳本生成旁白音檔（TTS）
  - 素材能正確儲存到 S3/R2

- [ ] **影片組裝**
  - 能將圖片、音檔、字幕組合成影片
  - 影片格式正確（MP4）
  - 影片能正常播放

- [ ] **進度顯示**
  - 用戶能看到當前處理狀態
  - 至少有「處理中」和「完成」兩種狀態
  - 出錯時能顯示錯誤訊息

- [ ] **預覽與下載**
  - 用戶能在瀏覽器預覽影片
  - 用戶能下載影片檔案
  - 下載的檔案能正常播放

### 重要但非必須（P1）

- [ ] 進度百分比顯示
- [ ] 生成歷史記錄
- [ ] 錯誤重試機制
- [ ] 腳本範例/範本

### 未來再做（P2）

- [ ] 用戶登入/註冊
- [ ] 批量生成
- [ ] 自訂風格
- [ ] 影片編輯

---

## 3. 關鍵品質指標（KPI）

### 功能性指標

| 指標 | 目標值 | 測量方式 |
|------|--------|----------|
| 影片生成成功率 | ≥ 80% | 成功生成數 / 總請求數 |
| 端到端完成時間 | ≤ 5 分鐘 | 從提交到可下載的時間 |
| 影片可播放率 | = 100% | 生成的影片都能正常播放 |

### 非功能性指標

| 指標 | 目標值 | 測量方式 |
|------|--------|----------|
| API 回應時間 | ≤ 3 秒 | 前端呼叫 API 的回應時間 |
| 系統可用性 | ≥ 95% | Uptime monitoring |
| 錯誤處理覆蓋率 | = 100% | 所有錯誤都有對應處理 |

### 成本指標

| 指標 | 目標值 | 測量方式 |
|------|--------|----------|
| 單支影片成本 | ≤ $0.50 | AI API + 儲存成本 |
| 每月固定成本 | ≤ $50 | 伺服器 + 網域等 |

---

## 4. 驗收流程

### 4.1 自動化驗收（產品層級）

建立一個端到端測試腳本 `scripts/verify-mvp.sh`：

```bash
#!/bin/bash

echo "=== CheapCut MVP 驗收測試 ==="

# 1. 健康檢查
echo "[1/5] 檢查服務是否運行..."
curl -f http://localhost:3000/api/health || exit 1

# 2. 提交腳本
echo "[2/5] 提交測試腳本..."
TASK_ID=$(curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{"script": "測試腳本。第一個場景。第二個場景。第三個場景。"}' \
  | jq -r '.taskId')

echo "任務 ID: $TASK_ID"

# 3. 等待完成
echo "[3/5] 等待影片生成..."
for i in {1..60}; do
  STATUS=$(curl -s http://localhost:3000/api/status/$TASK_ID | jq -r '.status')
  echo "當前狀態: $STATUS"

  if [ "$STATUS" = "completed" ]; then
    break
  elif [ "$STATUS" = "failed" ]; then
    echo "❌ 生成失敗"
    exit 1
  fi

  sleep 5
done

# 4. 下載影片
echo "[4/5] 下載影片..."
VIDEO_URL=$(curl -s http://localhost:3000/api/status/$TASK_ID | jq -r '.videoUrl')
curl -o test-output.mp4 "$VIDEO_URL"

# 5. 驗證影片
echo "[5/5] 驗證影片..."
ffprobe test-output.mp4 2>&1 | grep "Video:" || exit 1
ffprobe test-output.mp4 2>&1 | grep "Audio:" || exit 1

echo "✅ MVP 驗收測試通過！"
```

執行方式：
```bash
npm run verify:mvp
# 或
./scripts/verify-mvp.sh
```

### 4.2 手動驗收檢查清單

在自動化測試通過後，進行以下手動檢查：

- [ ] 打開瀏覽器訪問首頁，介面正常顯示
- [ ] 輸入測試腳本，提交成功
- [ ] 進度頁面能正確顯示狀態
- [ ] 影片預覽能正常播放
- [ ] 下載的影片檔案能在本地播放器播放
- [ ] 字幕與旁白同步
- [ ] 畫面與場景內容相符

---

## 5. 上線前檢查

### 5.1 技術就緒

- [ ] 所有 P0 功能測試通過
- [ ] 端到端測試通過
- [ ] 沒有 critical/high 的 bug
- [ ] 基本的錯誤處理都已實作
- [ ] 已部署到正式環境並測試

### 5.2 營運就緒

- [ ] 環境變數都已設定（API keys, S3 credentials）
- [ ] 監控系統已設置（如 Sentry, logs）
- [ ] 成本追蹤已設置
- [ ] 有基本的錯誤通知機制
- [ ] 有備份與還原計劃

### 5.3 產品就緒

- [ ] 有使用說明（即使很簡單）
- [ ] 有錯誤訊息文案（用戶看得懂）
- [ ] 有基本的 FAQ
- [ ] 有問題回報管道

---

## 6. 發布標準

### Alpha Release（內部測試）
- 核心功能能跑，但可能有 bug
- 僅給內部人員使用
- 目的：驗證主流程

### Beta Release（小範圍測試）
- 所有 P0 功能完成
- 成功率 ≥ 60%
- 給 10-20 位測試用戶
- 目的：收集反饋，找 bug

### MVP Release（公開上線）
- 所有 P0 功能完成且穩定
- 成功率 ≥ 80%
- 通過自動化驗收測試
- 通過手動檢查清單
- 目的：開始獲取真實用戶

---

## 7. 成功的定義

### 短期成功（上線第一週）
- 沒有系統性崩潰
- 至少 5 位用戶成功生成影片
- 成本在預算內

### 中期成功（上線第一個月）
- 有 50 位用戶使用
- 生成成功率 ≥ 80%
- 收到正面反饋
- 有用戶願意推薦

### 長期成功（3 個月內）
- 有穩定的用戶增長
- 產品符合市場需求（PMF）
- 成本結構健康
- 準備好進入下一階段（付費版、進階功能等）

---

## 8. 不合格的定義

以下情況視為 MVP **未達標**，需要修正後才能上線：

### 致命問題（Must Fix）
- 端到端流程跑不通
- 生成成功率 < 50%
- 有安全漏洞（如 API key 洩漏）
- 成本超出預算 2 倍以上
- 有資料遺失風險

### 嚴重問題（Should Fix）
- 錯誤訊息不明確
- 沒有任何錯誤處理
- 效能極差（生成時間 > 10 分鐘）
- 介面非常難用

---

## 附錄：驗收測試的測試案例

### 案例 1：正常流程
**輸入**：
```
這是一個關於貓咪的故事。
小貓在花園裡玩耍。
夕陽西下，小貓回家了。
```

**預期輸出**：
- 成功生成 3 個場景
- 影片長度約 30-60 秒
- 包含 3 張不同的圖片
- 有完整的旁白
- 有字幕

### 案例 2：邊界條件
**輸入**：
```
非常短。
```

**預期輸出**：
- 提示文字太短，要求至少 3 句話

### 案例 3：錯誤處理
**模擬**：AI API 回傳錯誤

**預期輸出**：
- 顯示友善的錯誤訊息
- 不會讓系統崩潰
- 有重試選項

---

**完成檢查**：
- [x] 定義了 MVP 的核心範圍
- [x] 列出了功能檢查清單
- [x] 設定了關鍵品質指標
- [x] 提供了驗收流程（自動化 + 手動）
- [x] 定義了上線標準
- [x] 定義了成功與失敗的標準

**完成後**：
- [ ] 更新 `00-INDEX.md`，標記步驟 8 完成
- [ ] 將原本的詳細設計分工移到 implementation-plan 資料夾
- [ ] 開始規劃執行計劃
